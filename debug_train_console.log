2026-02-20 19:49:42,735 | INFO | train | Run initialized: run_id=20260220_194942 out_dir=artifacts\exp_main_debug model=improved_unet3d
2026-02-20 19:49:42,736 | INFO | train | Dataset size: train=234 val=67 patch_size=(128, 128, 128)
Traceback (most recent call last):
  File "e:\code\python-llmlxm\python-llmlxm\train.py", line 251, in <module>
    main()
  File "e:\code\python-llmlxm\python-llmlxm\train.py", line 171, in main
    train_loss = run_epoch(model, train_loader, optimizer, criterion, device)
  File "e:\code\python-llmlxm\python-llmlxm\brats_seg\training\engine.py", line 35, in run_epoch
    logits = model(image)
  File "E:\code\python-llmlxm\python-llmlxm\.venv\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "E:\code\python-llmlxm\python-llmlxm\.venv\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "e:\code\python-llmlxm\python-llmlxm\brats_seg\models\improved_unet3d.py", line 62, in forward
    x1 = self.skip1_fuse(torch.cat(x1_mod, dim=1))
  File "E:\code\python-llmlxm\python-llmlxm\.venv\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "E:\code\python-llmlxm\python-llmlxm\.venv\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "E:\code\python-llmlxm\python-llmlxm\.venv\lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
  File "E:\code\python-llmlxm\python-llmlxm\.venv\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "E:\code\python-llmlxm\python-llmlxm\.venv\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "E:\code\python-llmlxm\python-llmlxm\.venv\lib\site-packages\torch\nn\modules\conv.py", line 725, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\code\python-llmlxm\python-llmlxm\.venv\lib\site-packages\torch\nn\modules\conv.py", line 720, in _conv_forward
    return F.conv3d(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 0 has a total capacity of 4.00 GiB of which 0 bytes is free. Of the allocated memory 10.44 GiB is allocated by PyTorch, and 20.74 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
